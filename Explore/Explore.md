---
Platform: HackTheBox
Category: Android
Difficulty: Easy
Status: Rooted/Finished
Type: Machine
Title: Explore
tags: 
CreatedOn: 04-12-2023
---
# Explore

Hello everyone, In this blog we are going to solve Explore from HackTheBox.

Link for the machine : [https://app.hackthebox.com/machines/356](https://app.hackthebox.com/machines/356)

  

Lets Start ðŸ™Œ

  

Connect to the HTB server by using the OpenVpn configuration file thatâ€™s generated by HTB.

[ [Click Here](https://help.hackthebox.com/en/articles/5185687-introduction-to-lab-access) to learn more about how to connect to vpn and access the boxes. ]

After connecting to the vpn service, click on Join Machine to access the machineâ€™s ip.

After joining the machine you can see the IP Address of the target machine.

  

First I started by scanning for open ports on the target machine.

![[Explore/assets/Untitled.png|Untitled.png]]

![[Explore/assets/Untitled 1.png|Untitled 1.png]]

![[Explore/assets/Untitled 2.png|Untitled 2.png]]

From the scan results we have found the following open ports:

|   |   |   |
|---|---|---|
|**Port**|**Service**|**Version**|
|2222|SSH|ssh2.0|
|46173|unknown|unknown|
|59777|HTTP|-|

On searching about the port 59777, found the following: [https://github.com/fs0c131y/ESFileExplorerOpenPortVuln](https://github.com/fs0c131y/ESFileExplorerOpenPortVuln)

On further research about the **CVE-2019-6447,** found the following exploit: [https://www.exploit-db.com/exploits/50070](https://www.exploit-db.com/exploits/50070)

Download the exploit and run it with python 3

![[Explore/assets/Untitled 3.png|Untitled 3.png]]

Now to list the files, execute the following command:`python3 50070.py listFiles 10.10.10.247 | grep name`

![[Explore/assets/Untitled 4.png|Untitled 4.png]]

Based on the output, nothing interesting was found. Next I tried to list the pictures.

Command:`python3 50070.py listPics 10.10.10.247`

![[Explore/assets/Untitled 5.png|Untitled 5.png]]

From the output, we can see a picture named `creds.jpg`, which sounds interesting.

So I decided to take a look it and downloaded the picture using the command:

`python3 50070.py getFile 10.10.10.247 /storage/emulated/0/DCIM/creds.jpg`

![[Explore/assets/Untitled 6.png|Untitled 6.png]]

Open the `out.dat` file with a image viewer.

![[Explore/assets/Untitled 7.png|Untitled 7.png]]

From the image, we have got the following credentials: `kristi:Kr1sT!5h@Rp3xPl0r3!`

Now try to login via SSH to the target using the found credentials.

While trying to login via SSH got the following error:

![[Explore/assets/Untitled 8.png|Untitled 8.png]]

On searching for solution for the above error, found this: [https://support.genymotion.com/hc/en-us/articles/9500420360093-I-get-the-error-no-matching-host-key-type-found-Their-offer-ssh-rsa-when-trying-to-connect-with-SSH](https://support.genymotion.com/hc/en-us/articles/9500420360093-I-get-the-error-no-matching-host-key-type-found-Their-offer-ssh-rsa-when-trying-to-connect-with-SSH)

To fix the error, use the `ssh` command as shown below:

Command:`ssh -p 2222 -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedAlgorithms=+ssh-rsa kristi@10.10.10.247`

![[Explore/assets/Untitled 9.png|Untitled 9.png]]

We have successfully logged in.

On surfing the file system, I found the flag at `/sdcard/` location.

![[Explore/assets/Untitled 10.png|Untitled 10.png]]

Next its time to escalate our privileges. I was looking out for privilege escalation vectors and found the `/etc/init.sh` script.

![[Explore/assets/Untitled 11.png|Untitled 11.png]]

On viewing the contents of the script, we can see that firewall blocks all the connections to the port 5555 from the outside and only allows access to it from localhost.

By default, ADB runs on port 5555 [ [https://book.hacktricks.xyz/network-services-pentesting/5555-android-debug-bridge](https://book.hacktricks.xyz/network-services-pentesting/5555-android-debug-bridge) ]. If we can connect to this device via adb, we can try to escalate our privileges.

For that first we need adb. I have it one my local machine. Since, firewall blocks external connections to port 5555, we have to create a tunnel to the target machine, and then use adb to escalate our privilege.

To create a tunnel I used SSH.

```
// Creating a tunnel to the target machine via SSH
ssh -p 2222 -o HostKeyAlgorithms=+ssh-rsa -o PubkeyAcceptedAlgorithms=+ssh-rsa kristi@10.10.10.247 -L localhost:5555:localhost:5555 -fN

// Here
// -L - Creates a link between the target machine port and our local machine port\
// -N - Tells SSH that we don't want to exectue any commands
// -f - Runs SSH in background
```

![[Explore/assets/Untitled 12.png|Untitled 12.png]]

After executing the command successfully, we can now connect to the target via adb using the command: `adb connect localhost:5555`

![[Explore/assets/Untitled 13.png|Untitled 13.png]]

Now lets open the interactive shell using the command: `adb -s localhost:5555 shell`

![[Explore/assets/Untitled 14.png|Untitled 14.png]]

Now use the `su` command to escalate our privilege as sudo/root.

![[Explore/assets/Untitled 15.png|Untitled 15.png]]

Found the flag at `/data/` directory.

![[Explore/assets/Untitled 16.png|Untitled 16.png]]

We have successfully found the root flag.

  

  

Thank Youâ€¦â€¦..