---
Platform: HackTheBox
Difficulty: Easy
tags:
  - default-credentials
Status: Rooted/Finished
Type: Machine
Title: Keeper
Category: 
CreatedOn: 04-12-2023
---
# Keeper

Hello everyone, In this blog we are going to solve Keeper from HackTheBox.

Link for the machine : [https://app.hackthebox.com/machines/Keeper](https://app.hackthebox.com/machines/Keeper)

  

Lets Start üôå

  

Connect to the HTB server by using the OpenVpn configuration file that‚Äôs generated by HTB.

[ [Click Here](https://help.hackthebox.com/en/articles/5185687-introduction-to-lab-access) to learn more about how to connect to vpn and access the boxes. ]

After connecting to the vpn service, click on Join Machine to access the machine‚Äôs ip.

After joining the machine you can see the IP Address of the target machine.

  

First I started by scanning for open ports on the target machine.

![Untitled.png](Keeper/assets/Untitled.png)

![Untitled 1.png](Keeper/assets/Untitled%201.png)

From the results of the scan, we can see that two ports are open:

|   |   |   |
|---|---|---|
|**Ports**|**Services**|**Version**|
|22|SSH|OpenSSH 8.9p1|
|80|HTTP|nginx 1.18.0|

Next I checked the `nginx` server running on port 80.

![Untitled 2.png](Keeper/assets/Untitled%202.png)

When I visited the website, I got the above link, the link redirected to `tickets.keeper.htb`.

![Untitled 3.png](Keeper/assets/Untitled%203.png)

You can see the above error on redirection. To view this site, we have to add this domain referring the target IP address in `/etc/hosts` file in our local machine.

Open the `/etc/hosts` file with your favourite text editor and add the following: `10.10.11.227 tickets.keeper.htb` to the `hosts` file.

![Untitled 4.png](Keeper/assets/Untitled%204.png)

Now revisit the website and refresh, you can see the following site:

![Untitled 5.png](Keeper/assets/Untitled%205.png)

This is a Request Tracker web-server. On searching about Request Tracker on google, looking out for default credentials, found this:

![Untitled 6.png](Keeper/assets/Untitled%206.png)

So, I tried the above mentioned credentials `root:password`, it worked:

![Untitled 7.png](Keeper/assets/Untitled%207.png)

  

  

After surfing the application for sometime, In the Admin > Users tab, I found another user:

![Untitled 8.png](Keeper/assets/Untitled%208.png)

On viewing the details of the user, I found the password.

![Untitled 9.png](Keeper/assets/Untitled%209.png)

So we found another user with the following credential: `lnorgaard:Welcome2023!`

I logged in with the above found credential.

![Untitled 10.png](Keeper/assets/Untitled%2010.png)

The dashboard was in Danish version, so I used Google Translate to translate the page to English. There was a ticket in queue, which stated ‚ÄúIssue with Keepass client on Windows‚Äù. On viewing the details of the ticket, it was mentioned that the crash file is attached as an attachment.

![Untitled 11.png](Keeper/assets/Untitled%2011.png)

But no attachment was found. After investigating for sometime, I noted the ticket ID and re logged in as the root user.

![Untitled 12.png](Keeper/assets/Untitled%2012.png)

As root user, I tried to search for the ticket with the ID that I noted.

![Untitled 13.png](Keeper/assets/Untitled%2013.png)

![Untitled 14.png](Keeper/assets/Untitled%2014.png)

From the history section of the results, we can devise that the user `lnorgaard` has downloaded and stored the crash file in his home directory.

So I logged in to the target via SSH using the credential: `lnorgaard:Welcome2023!`

![Untitled 15.png](Keeper/assets/Untitled%2015.png)

After logging in, I checked the home directory.

![Untitled 16.png](Keeper/assets/Untitled%2016.png)

In the home directory, I found the crash file as well as the user flag.

I started a simple HTTP server using python on the target machine and downloaded the crash file to the local machine to analyse.

![Untitled 17.png](Keeper/assets/Untitled%2017.png)

![Untitled 18.png](Keeper/assets/Untitled%2018.png)

Next I extracted the files using `unzip`.

![Untitled 19.png](Keeper/assets/Untitled%2019.png)

Two files got extracted from the zip, one is a memory dump file and another one is a keepass database.

![Untitled 20.png](Keeper/assets/Untitled%2020.png)

On searching about the keepass dump file on google, I found that it is vulnerable to `CVE-2023-32784`, i.e., there is a possibility that the masterkey for the keepass might be recorded in a crash report file. On searching more I found the following page: [https://github.com/CMEPW/keepass-dump-masterkey](https://github.com/CMEPW/keepass-dump-masterkey).

  

I downloaded the script from the above mentioned github page using `wget`.

`wget https://raw.githubusercontent.com/CMEPW/keepass-dump-masterkey/main/poc.py`

![Untitled 21.png](Keeper/assets/Untitled%2021.png)

Next I ran the script using the command:

`python3 poc.py -d KeePassDumpFull.dmp`

![Untitled 22.png](Keeper/assets/Untitled%2022.png)

From the results of the script, we got a possible list of passwords. Mostly the first 2 characters are differing in the list. So I tried searching on google with the balance two words and found the following:

![Untitled 23.png](Keeper/assets/Untitled%2023.png)

It seems like it is a Danish Delight. Let‚Äôs try `r√∏dgr√∏d med fl√∏de` as the master key. First to view the contents of a keepass database, you need keepass installed on your system. You can download and install keepass for your respected system from [https://keepass.info/download.html](https://keepass.info/download.html)

Next to open the database, type the following command: `keepass2 passcodes.kdbx`

![Untitled 24.png](Keeper/assets/Untitled%2024.png)

On the pop up screen enter the master key and hit ok.

![Untitled 25.png](Keeper/assets/Untitled%2025.png)

It worked:

![Untitled 26.png](Keeper/assets/Untitled%2026.png)

There was two entries. The entry with the title `keeper.htb` has the contents of a putty key file in the notes section:

![Untitled 27.png](Keeper/assets/Untitled%2027.png)

Copy this content and save it a putty key file (ppk). You can copy the notes by the following method:

![Untitled 28.png](Keeper/assets/Untitled%2028.png)

Now copy the contents of the notes and save it in a ppk file.

![Untitled 29.png](Keeper/assets/Untitled%2029.png)

![Untitled 30.png](Keeper/assets/Untitled%2030.png)

Now from the putty key that we got, we can generate a SSH Key using `puttygen`.

Command: `puttygen puttykey.ppk -O private-openssh -o idrsa.pem`

![Untitled 31.png](Keeper/assets/Untitled%2031.png)

Next using the generated key file, login via SSH to the target:

![Untitled 32.png](Keeper/assets/Untitled%2032.png)

Now we got access as root.

![Untitled 33.png](Keeper/assets/Untitled%2033.png)

And we have successfully found the root flag.

  

  

Thank You‚Ä¶‚Ä¶‚Ä¶..