---
Platform: HackTheBox
Difficulty: Easy
tags:
  - default-credentials
Status: Rooted/Finished
Type: Machine
Title: Keeper
Category: 
CreatedOn: 04-12-2023
---
# Keeper

Hello everyone, In this blog we are going to solve Keeper from HackTheBox.

Link for the machine : [https://app.hackthebox.com/machines/Keeper](https://app.hackthebox.com/machines/Keeper)

  

Lets Start üôå

  

Connect to the HTB server by using the OpenVpn configuration file that‚Äôs generated by HTB.

[ [Click Here](https://help.hackthebox.com/en/articles/5185687-introduction-to-lab-access) to learn more about how to connect to vpn and access the boxes. ]

After connecting to the vpn service, click on Join Machine to access the machine‚Äôs ip.

After joining the machine you can see the IP Address of the target machine.

  

First I started by scanning for open ports on the target machine.

![[Keeper/assets/Untitled.png|Untitled.png]]

![[Keeper/assets/Untitled 1.png|Untitled 1.png]]

From the results of the scan, we can see that two ports are open:

|   |   |   |
|---|---|---|
|**Ports**|**Services**|**Version**|
|22|SSH|OpenSSH 8.9p1|
|80|HTTP|nginx 1.18.0|

Next I checked the `nginx` server running on port 80.

![[Keeper/assets/Untitled 2.png|Untitled 2.png]]

When I visited the website, I got the above link, the link redirected to `tickets.keeper.htb`.

![[Keeper/assets/Untitled 3.png|Untitled 3.png]]

You can see the above error on redirection. To view this site, we have to add this domain referring the target IP address in `/etc/hosts` file in our local machine.

Open the `/etc/hosts` file with your favourite text editor and add the following: `10.10.11.227 tickets.keeper.htb` to the `hosts` file.

![[Keeper/assets/Untitled 4.png|Untitled 4.png]]

Now revisit the website and refresh, you can see the following site:

![[Keeper/assets/Untitled 5.png|Untitled 5.png]]

This is a Request Tracker web-server. On searching about Request Tracker on google, looking out for default credentials, found this:

![[Keeper/assets/Untitled 6.png|Untitled 6.png]]

So, I tried the above mentioned credentials `root:password`, it worked:

![[Keeper/assets/Untitled 7.png|Untitled 7.png]]

  

  

After surfing the application for sometime, In the Admin > Users tab, I found another user:

![[Keeper/assets/Untitled 8.png|Untitled 8.png]]

On viewing the details of the user, I found the password.

![[Keeper/assets/Untitled 9.png|Untitled 9.png]]

So we found another user with the following credential: `lnorgaard:Welcome2023!`

I logged in with the above found credential.

![[Keeper/assets/Untitled 10.png|Untitled 10.png]]

The dashboard was in Danish version, so I used Google Translate to translate the page to English. There was a ticket in queue, which stated ‚ÄúIssue with Keepass client on Windows‚Äù. On viewing the details of the ticket, it was mentioned that the crash file is attached as an attachment.

![[Keeper/assets/Untitled 11.png|Untitled 11.png]]

But no attachment was found. After investigating for sometime, I noted the ticket ID and re logged in as the root user.

![[Keeper/assets/Untitled 12.png|Untitled 12.png]]

As root user, I tried to search for the ticket with the ID that I noted.

![[Keeper/assets/Untitled 13.png|Untitled 13.png]]

![[Keeper/assets/Untitled 14.png|Untitled 14.png]]

From the history section of the results, we can devise that the user `lnorgaard` has downloaded and stored the crash file in his home directory.

So I logged in to the target via SSH using the credential: `lnorgaard:Welcome2023!`

![[Keeper/assets/Untitled 15.png|Untitled 15.png]]

After logging in, I checked the home directory.

![[Keeper/assets/Untitled 16.png|Untitled 16.png]]

In the home directory, I found the crash file as well as the user flag.

I started a simple HTTP server using python on the target machine and downloaded the crash file to the local machine to analyse.

![[Keeper/assets/Untitled 17.png|Untitled 17.png]]

![[Keeper/assets/Untitled 18.png|Untitled 18.png]]

Next I extracted the files using `unzip`.

![[Keeper/assets/Untitled 19.png|Untitled 19.png]]

Two files got extracted from the zip, one is a memory dump file and another one is a keepass database.

![[Keeper/assets/Untitled 20.png|Untitled 20.png]]

On searching about the keepass dump file on google, I found that it is vulnerable to `CVE-2023-32784`, i.e., there is a possibility that the masterkey for the keepass might be recorded in a crash report file. On searching more I found the following page: [https://github.com/CMEPW/keepass-dump-masterkey](https://github.com/CMEPW/keepass-dump-masterkey).

  

I downloaded the script from the above mentioned github page using `wget`.

`wget https://raw.githubusercontent.com/CMEPW/keepass-dump-masterkey/main/poc.py`

![[Keeper/assets/Untitled 21.png|Untitled 21.png]]

Next I ran the script using the command:

`python3 poc.py -d KeePassDumpFull.dmp`

![[Keeper/assets/Untitled 22.png|Untitled 22.png]]

From the results of the script, we got a possible list of passwords. Mostly the first 2 characters are differing in the list. So I tried searching on google with the balance two words and found the following:

![[Keeper/assets/Untitled 23.png|Untitled 23.png]]

It seems like it is a Danish Delight. Let‚Äôs try `r√∏dgr√∏d med fl√∏de` as the master key. First to view the contents of a keepass database, you need keepass installed on your system. You can download and install keepass for your respected system from [https://keepass.info/download.html](https://keepass.info/download.html)

Next to open the database, type the following command: `keepass2 passcodes.kdbx`

![[Keeper/assets/Untitled 24.png|Untitled 24.png]]

On the pop up screen enter the master key and hit ok.

![[Keeper/assets/Untitled 25.png|Untitled 25.png]]

It worked:

![[Keeper/assets/Untitled 26.png|Untitled 26.png]]

There was two entries. The entry with the title `keeper.htb` has the contents of a putty key file in the notes section:

![[Keeper/assets/Untitled 27.png|Untitled 27.png]]

Copy this content and save it a putty key file (ppk). You can copy the notes by the following method:

![[Keeper/assets/Untitled 28.png|Untitled 28.png]]

Now copy the contents of the notes and save it in a ppk file.

![[Keeper/assets/Untitled 29.png|Untitled 29.png]]

![[Keeper/assets/Untitled 30.png|Untitled 30.png]]

Now from the putty key that we got, we can generate a SSH Key using `puttygen`.

Command: `puttygen puttykey.ppk -O private-openssh -o idrsa.pem`

![[Keeper/assets/Untitled 31.png|Untitled 31.png]]

Next using the generated key file, login via SSH to the target:

![[Keeper/assets/Untitled 32.png|Untitled 32.png]]

Now we got access as root.

![[Keeper/assets/Untitled 33.png|Untitled 33.png]]

And we have successfully found the root flag.

  

  

Thank You‚Ä¶‚Ä¶‚Ä¶..